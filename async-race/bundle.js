(()=>{"use strict";var e={426:(e,t,n)=>{n.d(t,{Z:()=>s});var r=n(81),a=n.n(r),i=n(645),o=n.n(i)()(a());o.push([e.id,"* {\r\n  box-sizing: border-box;\r\n}\r\n\r\nbody {\r\n  background-color: #3b669c;\r\n  color: #e6e6e6;\r\n  font-family: 'Short Stack';\r\n  font-weight: 400;\r\n}\r\n\r\nimg {\r\n  max-width: 100%;\r\n  max-height: 100%;\r\n}\r\n\r\nbutton {\r\n  background-color: #bd4291;\r\n  cursor: pointer;\r\n  border: none;\r\n  border-radius: 12px;\r\n  height: 25px;\r\n  width: 80px;\r\n  font-family: cursive;\r\n  font-size: 14px;\r\n}\r\n\r\nbutton.btn-primary {\r\n  background-color: #37e2d5;\r\n}\r\n\r\nbutton.btn-long {\r\n  width: 120px;\r\n}\r\n\r\nbutton.btn-disabled {\r\n  background-color: #ababab;\r\n  color: #444;\r\n  pointer-events: none;\r\n}\r\n\r\nbutton.waiting {\r\n  background-color: #006fd6;\r\n  pointer-events: none;\r\n}\r\n\r\n.garage-view {\r\n  position: relative;\r\n}\r\n\r\n.garage-view.hidden,\r\n.winners-view.hidden {\r\n  display: none;\r\n}\r\n\r\n.container {\r\n  max-width: 1920px;\r\n  padding: 0 10px;\r\n  margin: 0 auto;\r\n}\r\n\r\n.cars-updater.disabled {\r\n  pointer-events: none;\r\n}\r\n.cars-updater.disabled button,\r\n.cars-updater.disabled input {\r\n  background-color: #ababab;\r\n  color: #444;\r\n}\r\n\r\n.cars-wrapper {\r\n  margin-bottom: 60px;\r\n}\r\n\r\n.car.selected .car-name {\r\n  animation-name: pulse;\r\n  animation-duration: .5s;\r\n  animation-iteration-count: infinite;\r\n}\r\n\r\n.car.selected .car-select {\r\n  color: white;\r\n}\r\n\r\n.car button {\r\n  font-size: 13px;\r\n}\r\n\r\n.car-color {\r\n  height: 22px;\r\n}\r\n\r\n.car-name {\r\n  margin-bottom: 5px;\r\n}\r\n\r\n.car-tools {\r\n  margin-bottom: 5px;\r\n}\r\n\r\n.car-start {\r\n  background-color: #53Bf9d;\r\n}\r\n\r\n.car-return {\r\n  background-color: #eb4038;\r\n}\r\n\r\n.car-track {\r\n  border-bottom: dashed white 2px;\r\n  display: flex;\r\n  justify-content: space-between; \r\n  align-items: flex-end;\r\n}\r\n\r\n.car-model {\r\n  width: 50px;\r\n}\r\n\r\n.car-model svg {\r\n  transform: translateY(11px);\r\n}\r\n\r\n.finish {\r\n  height: 60px;\r\n  width: 60px;\r\n  margin-right: 30px;\r\n}\r\n\r\n.winner-message {\r\n  position: absolute;\r\n  top: 50vh;\r\n  left: 50vw;\r\n  transform: translate(-50%);\r\n  font-size: 20px;\r\n  background-color: red;\r\n}\r\n\r\n.winners-table {\r\n  margin-bottom: 60px;\r\n}\r\n\r\n.winners-table\r\nth,\r\ntd {\r\n  border: 1px solid grey;\r\n  padding: 8px;\r\n}\r\n\r\n.winners-table img {\r\n  width: 40px;\r\n}\r\n\r\n.winners-table {\r\n  counter-reset: counter; \r\n}\r\n\r\n.winners-table tr td:first-child:before {\r\n  position: relative;\r\n  counter-increment: counter;\r\n  content: counter(counter);\r\n}\r\n\r\n@keyframes pulse {\r\n  0% {\r\n    transform: translateY(0);\r\n  }\r\n  50% {\r\n    transform: translateY(-3px);\r\n  }\r\n  100% {\r\n    transform: translateY(0);\r\n  }\r\n}\r\n\r\n.sort-btn {\r\n  cursor: pointer;\r\n}\r\n\r\n.sort-btn.sorted-asc::after {\r\n  content: '↑'\r\n}\r\n.sort-btn.sorted-desc::after {\r\n  content: '↓'\r\n}",""]);const s=o},645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,a,i){"string"==typeof e&&(e=[[null,e,void 0]]);var o={};if(r)for(var s=0;s<this.length;s++){var c=this[s][0];null!=c&&(o[c]=!0)}for(var d=0;d<e.length;d++){var l=[].concat(e[d]);r&&o[l[0]]||(void 0!==i&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=i),n&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=n):l[2]=n),a&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=a):l[4]="".concat(a)),t.push(l))}},t}},81:e=>{e.exports=function(e){return e[1]}},654:(e,t,n)=>{n.r(t),n.d(t,{default:()=>g});var r=n(379),a=n.n(r),i=n(795),o=n.n(i),s=n(569),c=n.n(s),d=n(565),l=n.n(d),u=n(216),h=n.n(u),m=n(589),v=n.n(m),p=n(426),f={};f.styleTagTransform=v(),f.setAttributes=l(),f.insert=c().bind(null,"head"),f.domAPI=o(),f.insertStyleElement=h(),a()(p.Z,f);const g=p.Z&&p.Z.locals?p.Z.locals:void 0},379:e=>{var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var i={},o=[],s=0;s<e.length;s++){var c=e[s],d=r.base?c[0]+r.base:c[0],l=i[d]||0,u="".concat(d," ").concat(l);i[d]=l+1;var h=n(u),m={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==h)t[h].references++,t[h].updater(m);else{var v=a(m,r);r.byIndex=s,t.splice(s,0,{identifier:u,updater:v,references:1})}o.push(u)}return o}function a(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,a){var i=r(e=e||[],a=a||{});return function(e){e=e||[];for(var o=0;o<i.length;o++){var s=n(i[o]);t[s].references--}for(var c=r(e,a),d=0;d<i.length;d++){var l=n(i[d]);0===t[l].references&&(t[l].updater(),t.splice(l,1))}i=c}}},569:e=>{var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},216:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},795:e=>{e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var a=void 0!==n.layer;a&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,a&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},873:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=a(n(149)),o=a(n(134)),s=a(n(345)),c=a(n(625));t.default=class{constructor(){this.container=document.createElement("div"),this.garageView=i.default.getInstance(),this.garageHandler=new s.default,this.winnersView=o.default.getInstance(),this.winnerHandler=new c.default}run(){return r(this,void 0,void 0,(function*(){this.renderStartPage(),yield this.garageHandler.stuffCarsWrapper(),yield this.garageHandler.initItemCounter(),yield this.winnerHandler.updateTable()}))}renderStartPage(){var e,t;this.container.className="container";const n=document.createElement("div");n.innerHTML='\n    <div class="nav">\n      <button class="garage-btn btn-primary">Garage</button>\n      <button class="winners-btn btn-primary">Winners</button>\n    </div>',null===(e=n.querySelector(".garage-btn"))||void 0===e||e.addEventListener("click",(()=>this.goToGarage())),null===(t=n.querySelector(".winners-btn"))||void 0===t||t.addEventListener("click",(()=>this.goToWinners())),this.container.append(n.children[0]),this.container.append(this.garageView.viewE,this.winnersView.viewE),document.body.append(this.container)}hide(e){e.classList.add("hidden")}show(e){e.classList.remove("hidden")}goToGarage(){this.hide(this.winnersView.viewE),this.show(this.garageView.viewE)}goToWinners(){return r(this,void 0,void 0,(function*(){yield this.winnerHandler.updateTable(),this.hide(this.garageView.viewE),this.show(this.winnersView.viewE)}))}}},218:function(e,t){var n,r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.cars="/garage",e.baseURL="http://127.0.0.1:3000",e.page="_page=",e.limit="_limit=",e.engine="/engine",e.winners="/winners",e.sort="_sort=",e.order="_order="}(n||(n={})),t.default=class{getCars(e,t){return r(this,void 0,void 0,(function*(){return(yield fetch(`${n.baseURL}${n.cars}?${n.page}${e}&${n.limit}${t}`)).json()}))}getCar(e){return r(this,void 0,void 0,(function*(){return(yield fetch(`${n.baseURL}${n.cars}/${e}`)).json()}))}addCar(e){return r(this,void 0,void 0,(function*(){const t=yield fetch(`${n.baseURL}${n.cars}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return yield t.json()}))}removeCar(e){return r(this,void 0,void 0,(function*(){yield fetch(`${n.baseURL}${n.cars}/${e}`,{method:"DELETE"})}))}updateCar(e,t){return r(this,void 0,void 0,(function*(){yield fetch(`${n.baseURL}${n.cars}/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}))}getTotalItems(){return r(this,void 0,void 0,(function*(){return(yield fetch(`${n.baseURL}${n.cars}?${n.limit}0`)).headers.get("X-Total-Count")}))}startEngine(e){return r(this,void 0,void 0,(function*(){const t=yield fetch(`${n.baseURL}${n.engine}?id=${e}&status=started`,{method:"PATCH"});return yield t.json()}))}stopEngine(e){return r(this,void 0,void 0,(function*(){const t=yield fetch(`${n.baseURL}${n.engine}?id=${e}&status=stopped`,{method:"PATCH"});return yield t.json()}))}driveEngine(e){return r(this,void 0,void 0,(function*(){try{const t=yield fetch(`${n.baseURL}${n.engine}?id=${e}&status=drive`,{method:"PATCH"});return yield t.json()}catch(e){return{success:!1}}}))}getWinners(e,t,a,i){return r(this,void 0,void 0,(function*(){const r=yield fetch(`${n.baseURL}${n.winners}?${n.page}${e}&${n.limit}${t}&${n.sort}${a}&${n.order}${i}`);return{winners:yield r.json(),count:r.headers.get("X-Total-Count")}}))}getWinner(e){return r(this,void 0,void 0,(function*(){return(yield fetch(`${n.baseURL}${n.winners}/${e}`)).json()}))}createWinner(e){return r(this,void 0,void 0,(function*(){return yield fetch(`${n.baseURL}${n.winners}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}))}updateWinner(e){return r(this,void 0,void 0,(function*(){const{id:t,wins:r,time:a}=e;return yield fetch(`${n.baseURL}${n.winners}/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({wins:r,time:a})})}))}removeWinner(e){return r(this,void 0,void 0,(function*(){yield fetch(`${n.baseURL}${n.winners}/${e}`,{method:"DELETE"})}))}}},727:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=a(n(218)),o=a(n(149)),s=a(n(625));t.default=class{constructor(){this.communicator=new i.default,this.winnersHandler=new s.default}startEngine(e){return r(this,void 0,void 0,(function*(){e.classList.add("onDrive");const t=e.querySelector(".car-start");t.className="car-start waiting";const{velocity:n,distance:r}=yield this.communicator.startEngine(e.dataset.id);t.className="car-start btn-disabled",e.querySelector(".car-return").classList.remove("btn-disabled");const a=r/n,i=yield this.startDriving(a,e);return i?{car:i,time:a}:Promise.reject(new Error("Unsuccessful drive"))}))}startDriving(e,t){return r(this,void 0,void 0,(function*(){const{model:n,trackWidth:a,step:i}=this.getAnimationParams(t,e);let o=0,s=0;const c=()=>{o+=i,n.style.transform=`translateX(${o}px)`,o<a&&(s=requestAnimationFrame(c),t.dataset.animationId=s.toString())};c();let d=!0;t.querySelector(".car-return").addEventListener("click",(()=>r(this,void 0,void 0,(function*(){d=yield this.returnCar(t,s)}))));const l=yield this.communicator.driveEngine(t.dataset.id);return cancelAnimationFrame(s),d&&t.parentNode&&l.success?t:null}))}returnCar(e,t){return r(this,void 0,void 0,(function*(){cancelAnimationFrame(t),e.classList.remove("onDrive");const n=e.querySelector(".car-return");return n.className="car-return waiting",yield this.communicator.stopEngine(e.dataset.id),e.querySelector(".car-model").style.transform="translateX(0px)",e.querySelector(".car-start").classList.remove("btn-disabled"),n.className="car-return btn-disabled",!1}))}getAnimationParams(e,t){const n=e.querySelector(".car-model"),r=e.querySelector(".car-track").offsetWidth-n.offsetWidth;return{model:n,trackWidth:r,step:r/(t/1e3*60)}}startRace(e,t){var n;return r(this,void 0,void 0,(function*(){if(o.default.getInstance().checkForDrivingCars())alert("You need to return all cars to their initial place in order to start a race");else{t.classList.add("btn-disabled");const r=o.default.getInstance().viewE;r.querySelectorAll(".pagination > *").forEach((e=>{e.classList.add("btn-disabled")})),null===(n=r.querySelector(".reset-btn"))||void 0===n||n.classList.add("btn-disabled");const a=e.map((e=>this.startEngine(e)));try{this.makeWinner(yield Promise.any(a))}catch(e){this.makeWinner(null)}}}))}makeWinner(e){var t,n;const r=o.default.getInstance().createElement("div","winner-message");if(e){const n=+(e.time/1e3).toFixed(2),a=null===(t=e.car.querySelector(".car-name"))||void 0===t?void 0:t.textContent;r.textContent=`${a} finished first in ${n}s.`,this.winnersHandler.makeWinner(+e.car.dataset.id,n)}else r.textContent="There are no winner";const a=o.default.getInstance().viewE;a.append(r),null===(n=a.querySelector(".reset-btn"))||void 0===n||n.classList.remove("btn-disabled")}resetRace(e,t){var n,r;t.classList.add("btn-disabled");const a=o.default.getInstance(),i=a.viewE;null===(n=i.querySelector(".winner-message"))||void 0===n||n.remove();for(let t=0;t<e.length;t+=1)this.returnCar(e[t],+e[t].dataset.animationId);null===(r=i.querySelector(".race-btn"))||void 0===r||r.classList.remove("btn-disabled"),a.checkPaginationButtons(a)}}},345:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(750),o=a(n(149)),s=a(n(218));t.default=class{constructor(){this.communicator=new s.default,this.selectedCar=null}stuffCarsWrapper(){return r(this,void 0,void 0,(function*(){const e=o.default.getInstance();(yield this.communicator.getCars(e.pageCount,e.LIMIT)).forEach((t=>{this.communicator.stopEngine(t.id),e.appendCar(e.createCarE(t))}))}))}initItemCounter(){return r(this,void 0,void 0,(function*(){const e=yield this.communicator.getTotalItems();this.updateItemsCounter(+e)}))}handleCarAdding(e,t){return r(this,void 0,void 0,(function*(){e.value.trim()?(yield this.addCar(e.value,t.value),e.value="",t.value="#000000"):alert("Please enter some name for a car")}))}addCar(e,t){return r(this,void 0,void 0,(function*(){const n={name:e,color:t},r=yield this.communicator.addCar(n),a=o.default.getInstance();a.carsWrapper.childNodes.length<a.LIMIT&&a.appendCar(a.createCarE(r)),this.updateItemsCounter(a.itemsCount+=1)}))}generateCars(){for(let e=0;e<100;e+=1)this.addCar((0,i.generateCarName)(),(0,i.generateCarColor)())}handleCarRemoving(e){return r(this,void 0,void 0,(function*(){e.remove();const t=o.default.getInstance();e===this.selectedCar&&this.removeFromSelected(e);const n=e.dataset.id;yield this.communicator.removeWinner(n),yield this.communicator.removeCar(n),this.updateItemsCounter(t.itemsCount-=1);const r=(yield this.communicator.getCars(t.pageCount,t.LIMIT))[t.LIMIT-1];r&&t.appendCar(t.createCarE(r)),t.carsWrapper.childNodes.length<1&&t.pageCount>1&&this.updatePage(t.pageCount-=1)}))}handleCarSelection(e){return r(this,void 0,void 0,(function*(){this.selectedCar===e?this.removeFromSelected(e):(this.removeFromSelected(this.selectedCar),this.addToSelected(e))}))}removeFromSelected(e=this.selectedCar){const{carsUpdater:t,carName:n,carColor:r}=this.getUpdatingControls();null==t||t.classList.add("disabled"),this.selectedCar=null,n.value="",r.value="#000000",null==e||e.classList.remove("selected")}addToSelected(e){var t,n;const{carsUpdater:r,carName:a,carColor:i}=this.getUpdatingControls();null==r||r.classList.remove("disabled"),a.value=null===(t=e.querySelector(".car-name"))||void 0===t?void 0:t.textContent,i.value=null===(n=e.querySelector(".car-model svg"))||void 0===n?void 0:n.getAttribute("fill"),this.selectedCar=e,e.classList.add("selected")}getUpdatingControls(){const e=o.default.getInstance().viewE.querySelector(".cars-updater");return{carsUpdater:e,carName:null==e?void 0:e.querySelector(".car-name"),carColor:null==e?void 0:e.querySelector(".car-color")}}handleCarUpdating(e,t){var n,a,i,o;return r(this,void 0,void 0,(function*(){const r=e.value;if(r.trim()){const e=t.value;this.communicator.updateCar(null===(n=this.selectedCar)||void 0===n?void 0:n.dataset.id,{name:r,color:e}),(null===(a=this.selectedCar)||void 0===a?void 0:a.querySelector(".car-name")).textContent=r,null===(o=null===(i=this.selectedCar)||void 0===i?void 0:i.querySelector(".car-model svg"))||void 0===o||o.setAttribute("fill",e),this.removeFromSelected(this.selectedCar)}else alert("Please enter some name for a car")}))}updatePage(e){return r(this,void 0,void 0,(function*(){const t=o.default.getInstance(),n=yield this.communicator.getCars(e,t.LIMIT);o.default.getInstance().replaceCars(n),t.updatePageCounter(t),t.checkPaginationButtons(t),this.removeFromSelected()}))}updateItemsCounter(e=0){const{viewE:t}=o.default.getInstance();t.querySelector(".total-counter").textContent=e.toString();const n=o.default.getInstance();n.itemsCount=e,n.checkPaginationButtons(n)}}},625:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=a(n(134)),o=a(n(218));t.default=class{constructor(){this.communicator=new o.default}makeWinner(e,t){return r(this,void 0,void 0,(function*(){if((yield(yield this.communicator.getWinners()).winners).some((t=>t.id===e))){const n=yield this.communicator.getWinner(e);let r=n.time;t<r&&(r=t),this.communicator.updateWinner({id:e,wins:n.wins+1,time:r})}else this.createWinner({id:e,wins:1,time:t})}))}createWinner(e){return r(this,void 0,void 0,(function*(){this.communicator.createWinner(e)}))}updateWinner(e){return r(this,void 0,void 0,(function*(){this.communicator.updateWinner(e)}))}updateTable(e=i.default.getInstance().pageCount,t=i.default.getInstance().LIMIT,n=i.default.getInstance().currentSort,a=i.default.getInstance().currentOrder){return r(this,void 0,void 0,(function*(){const o=i.default.getInstance();o.body.innerHTML="";const{winners:s,count:c}=yield this.communicator.getWinners(e,t,n,a);o.itemsCount=+c,o.viewE.querySelector(".total-counter").textContent=c,(yield s).forEach((e=>r(this,void 0,void 0,(function*(){const{id:t,wins:n,time:r}=e,{color:a,name:i}=yield this.communicator.getCar(t),s=o.createWinnerRow(a,i,n,r);o.body.append(s)})))),o.checkPaginationButtons(o)}))}updatePage(e){const t=i.default.getInstance();this.updateTable(t.pageCount=e),t.updatePageCounter(t)}sort(e,t,n){let r;n.className="sort-btn",t.classList.contains("sorted-asc")?(t.classList.remove("sorted-asc"),t.classList.add("sorted-desc"),r="DESC"):(t.classList.remove("sorted-desc"),t.classList.add("sorted-asc"),r="ASC"),i.default.getInstance().currentSort=e,i.default.getInstance().currentOrder=r,this.updateTable(void 0,void 0,e,r)}}},607:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(n(873));n(654),(new a.default).run()},750:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateCarColor=t.generateCarName=void 0;const n=["Tesla","BMW","Mercedes","Audi","Toyota","Lexus","Hyundai","Ford","Renault","Fiat"],r=["Model X","X5","E-tron","A5","Supra","Rx 350","Tucson","Focus","Logan","Uno"];t.generateCarName=function(){return`${n[Math.floor(Math.random()*n.length)]} ${r[Math.floor(Math.random()*r.length)]}`},t.generateCarColor=function(){const e="0123456789abcdef";let t="#";for(let n=0;n<6;n+=1)t+=e[Math.floor(Math.random()*e.length)];return t}},149:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=a(n(234)),o=a(n(345)),s=a(n(727));class c extends i.default{constructor(){super(...arguments),this.LIMIT=7,this.handler=new o.default,this.driving=new s.default,this.carsWrapper=this.createCarsWrapper(),this.viewE=this.createView(),this.itemsCount=0,this.pageCount=1}static getInstance(){return c.Instance||(c.Instance=new c),c.Instance}createView(){const e=this.createElement("div","garage-view");return e.append(this.createTitle("Garage"),this.createCarsManager(),this.createPageCounter(),this.createControls(),this.carsWrapper,this.createPagination(this)),e}createCarsManager(){const e=this.createElement("div","cars-manager");return e.append(this.createCarCreator(),this.createCarsUpdater()),e}createCarCreator(){const e=this.createElement("div","car-creator"),t=this.createElement("input","car-name"),n=this.createElement("input","car-color");n.type="color";const a=this.createElement("button","creation-btn","Create");return a.addEventListener("click",(()=>r(this,void 0,void 0,(function*(){return this.handler.handleCarAdding(t,n)})))),e.append(t,n,a),e}createCarsUpdater(){const e=this.createElement("div","cars-updater disabled"),t=this.createElement("input","car-name"),n=this.createElement("input","car-color");n.type="color";const r=this.createElement("button","update-btn","Update");return r.addEventListener("click",(()=>this.handler.handleCarUpdating(t,n))),e.append(t,n,r),e}createControls(){const e=this.createElement("div","controls"),t=this.createElement("button","race-btn btn-primary","Race"),n=this.createElement("button","reset-btn btn-primary btn-disabled","Reset"),r=this.createElement("button","generate-btn btn-long","Generate cars");return r.addEventListener("click",(()=>this.handler.generateCars())),t.addEventListener("click",(()=>this.driving.startRace(Array.from(this.carsWrapper.childNodes),t))),n.addEventListener("click",(()=>this.driving.resetRace(Array.from(this.carsWrapper.querySelectorAll(".onDrive")),n))),e.append(t,n,r),e}createCarsWrapper(){return this.createElement("div","cars-wrapper")}replaceCars(e){const t=e.map((e=>this.createCarE(e)));this.carsWrapper.replaceChildren(...t)}createCarE(e){var t,n,a;const{name:i,color:o,id:s}=e,c=this.createElementFromMarkup(`\n    <div class="car" data-id="${s}">\n      <h3 class="car-name">${i}</h3>\n      <div class="car-tools">\n        <button class="car-select">Select</button>\n        <button class="car-remove">Remove</button>\n      </div>\n      <div class="car-controls">\n        <button class="car-start">Start</button>\n        <button class="car-return btn-disabled">Return</button>\n      </div>\n      <div class="car-track">\n        <div class="car-model">\n          ${this.createImage(o)}\n        </div>\n        <div class="finish">\n          <img src="./assets/finish-flag.svg" alt="finish">\n        </div>\n      </div>\n    </div>`);return null===(t=c.querySelector(".car-remove"))||void 0===t||t.addEventListener("click",(()=>this.handler.handleCarRemoving(c))),null===(n=c.querySelector(".car-select"))||void 0===n||n.addEventListener("click",(()=>this.handler.handleCarSelection(c))),null===(a=c.querySelector(".car-start"))||void 0===a||a.addEventListener("click",(()=>r(this,void 0,void 0,(function*(){var e;try{yield this.driving.startEngine(c)}catch(t){console.log(`${null===(e=c.querySelector(".car-name"))||void 0===e?void 0:e.textContent} was unable to complete the ride`)}})))),c}appendCar(e){this.carsWrapper.append(e)}checkForDrivingCars(){return Array.from(this.carsWrapper.childNodes).some((e=>e.classList.contains("onDrive")))}}t.default=c},234:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{createTitle(e){return this.createElementFromMarkup(`\n    <h1 class="title">\n      ${e}(<span class="total-counter">0</span>)\n    </h1>`)}createPageCounter(){return this.createElementFromMarkup('<h2 class="page-counter">Page #<span class="page-num">1</span></h2>')}createImage(e){return`\n    <svg fill="${e}" version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 470 470" xmlns:xlink="http://www.w3.org/1999/xlink" enable-background="new 0 0 470 470">\n    <g>\n      <path d="m126.184,358.951c19.299,0 35-15.701 35-35s-15.701-35-35-35-35,15.701-35,35 15.701,35 35,35zm0-55c11.028,0 20,8.972 20,20s-8.972,20-20,20-20-8.972-20-20 8.971-20 20-20z"/>\n      <path d="m343.816,288.951c-19.299,0-35,15.701-35,35s15.701,35 35,35 35-15.701 35-35-15.701-35-35-35zm0,55c-11.028,0-20-8.972-20-20s8.972-20 20-20 20,8.972 20,20-8.971,20-20,20z"/>\n      <path d="m137.5,116.049h23.779c4.143,0 7.5-3.358 7.5-7.5s-3.357-7.5-7.5-7.5h-23.779c-10.423,0-27.031,7.176-34.177,14.767l-60.088,63.845c-2.051,2.179-2.609,5.368-1.423,8.115 1.187,2.747 3.893,4.525 6.885,4.525h290.271c2.562,0 4.945-1.307 6.323-3.467 1.377-2.159 1.558-4.873 0.478-7.195l-30.854-66.365c-3.315-7.046-14.628-14.225-22.415-14.225h-101.221c-4.143,0-7.5,3.358-7.5,7.5l-.001,68.752h-117.722l48.19-51.204c4.243-4.508 17.066-10.048 23.254-10.048zm61.279,0h93.7c2.203,0.103 7.842,3.681 8.849,5.581l25.883,55.671h-128.433l.001-61.252z"/>\n      <path d="m470,257.692c0-26.631-20.555-55.149-45.819-63.57-0.017-0.006-35.078-11.693-35.078-11.693-5.854-1.951-13.576-8.812-16.203-14.394l-30.84-65.535c-8.299-17.636-30.068-31.451-49.56-31.451h-155c-18.639,0-43.247,10.632-56.022,24.206l-69.158,73.482c-6.909,7.34-12.32,20.984-12.32,31.064v94.15c0,20.678 16.822,37.5 37.5,37.5h14.06c3.775,37.846 35.8,67.5 74.624,67.5s70.849-29.654 74.624-67.5h45.509c4.143,0 7.5-3.358 7.5-7.5s-3.357-7.5-7.5-7.5h-45.509c-3.775-37.846-35.8-67.5-74.624-67.5s-70.849,29.654-74.624,67.5h-14.06c-12.406,0-22.5-10.093-22.5-22.5v-94.15c0-6.294 3.929-16.2 8.242-20.783l69.159-73.483c9.941-10.563 30.594-19.486 45.099-19.486h155c13.682,0 30.162,10.458 35.987,22.838l30.84,65.535c4.421,9.395 15.182,18.955 25.031,22.238l28.498,9.499c-0.492,2.841-0.748,5.729-0.748,8.642 0,25.238 18.65,46.198 42.892,49.831v29.32c0,12.407-8.357,22.5-18.631,22.5h-17.929c-3.775-37.846-35.8-67.5-74.624-67.5-41.355,0-75,33.645-75,75s33.645,75 75,75c38.824,0 70.849-29.654 74.624-67.5h17.929c18.544,0 33.631-16.822 33.631-37.5v-36.26zm-343.816,6.259c33.084,0 60,26.916 60,60s-26.916,60-60,60-60-26.916-60-60 26.916-60 60-60zm217.632,120c-33.084,0-60-26.916-60-60s26.916-60 60-60 60,26.916 60,60-26.916,60-60,60zm83.292-169.15c0-0.969 0.04-1.934 0.117-2.893 13.16,7.627 23.787,22.37 26.864,37.266-15.466-3.785-26.981-17.756-26.981-34.373z"/>\n    </g>\n  </svg>\n    `}createElement(e,t,n=""){const r=document.createElement(e);return r.className=t,r.textContent=n,r}createElementFromMarkup(e){const t=document.createElement("div");return t.innerHTML=e,t.children[0]}createPagination(e){const t=this.createElementFromMarkup('\n    <div class="pagination">\n      <button class="prev-btn btn-primary">Previous</button>\n      <button class="next-btn btn-primary">Next</button>\n    </div>');return t.querySelector(".prev-btn").addEventListener("click",(()=>{e.handler.updatePage(e.pageCount-=1)})),t.querySelector(".next-btn").addEventListener("click",(()=>{e.handler.updatePage(e.pageCount+=1)})),t}checkPaginationButtons(e){const t=e.viewE.querySelector(".prev-btn");e.pageCount<2?t.classList.add("btn-disabled"):t.classList.remove("btn-disabled");const n=e.viewE.querySelector(".next-btn");e.itemsCount<=e.pageCount*e.LIMIT?n.classList.add("btn-disabled"):n.classList.remove("btn-disabled")}updatePageCounter(e){const{viewE:t,pageCount:n}=e;t.querySelector(".page-num").textContent=n.toString()}}},134:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(n(625)),i=r(n(234));class o extends i.default{constructor(){super(...arguments),this.LIMIT=10,this.viewE=this.createView(),this.body=this.viewE.querySelector("tbody"),this.handler=new a.default,this.itemsCount=0,this.pageCount=1}static getInstance(){return o.Instance||(o.Instance=new o),o.Instance}createView(){const e=this.createElement("div","winners-view hidden");return e.append(this.createTitle("Winners"),this.createPageCounter(),this.createTable(),this.createPagination(this)),e}createTable(){const e=this.createElementFromMarkup('\n  <table class="winners-table">\n    <thead>\n      <tr>\n        <th>Number</th>\n        <th>Car</th>\n        <th>Name</th>\n        <th class="wins-sort sort-btn">Wins</th>\n        <th class="time-sort sort-btn">Best time</th>\n      </tr>\n    </thead>\n    <tbody>\n    </tbody>\n  </table>'),t=e.querySelector(".wins-sort"),n=e.querySelector(".time-sort");return t.addEventListener("click",(()=>{this.handler.sort("wins",t,n)})),n.addEventListener("click",(()=>{this.handler.sort("time",n,t)})),e}createWinnerRow(e,t,n,r){const a=document.createElement("tbody");return a.innerHTML=`\n    <tr>\n      <td></td>\n      <td>${this.createImage(e)}</td>\n      <td>${t}</td>\n      <td>${n}</td>\n      <td>${r}s</td>\n    </tr>`,a.children[0]}}t.default=o}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={id:r,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nc=void 0,n(607)})();